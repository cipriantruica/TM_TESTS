From: gdmr@dcs.ed.ac.uk (George Ross) Subject: twm & greyscale  As distributed, twm thinks everything with three or more colormap cells must be a colour screen.  Here is a patch to have it use the screen is visual class.  *** twm.c.DIST\tWed May 12 14:56:55 1993 --- twm.c\tWed May 12 15:47:53 1993 *************** *** 343,352 **** --- 343,384 ----      \tScr->XORvalue = (((unsigned long) 1) d_depth) - 1;    +   oldCode   \tif (DisplayCells(dpy, scrnum) Monochrome = MONOCHROME;   \telse   \t    Scr->Monochrome = COLOR; +   + \t{\tXVisualInfo template; + \t\tXVisualInfo *visualInfo; + \t\tint nitems; +  + \t\ttemplate.visual = DefaultVisual(dpy, scrnum); + \t\ttemplate.visualid = XVisualIDFromVisual(template.visual); + \t\ttemplate.screen = scrnum; + \t\tvisualInfo = XGetVisualInfo(dpy, VisualIDMask|VisualScreenMask, + \t\t\t\t&template, &nitems); + \t\tif (nitems == 1) { + \t\t\tswitch (visualInfo->class) { + \t\tcase StaticColor: + \t\tcase PseudoColor: + \t\tcase TrueColor: + \t\tcase DirectColor: + \t\t\t\tScr->Monochrome = COLOR; + \t\t\t\tbreak; +  + \t\tdefault:\tScr->Monochrome = MONOCHROME; + \t\t\t\tbreak; + \t\t\t} + \t\t} + \t\telse { + \t\t\t(void) fprintf(stderr, + \t\t\t\t\t %d Visual match(es), assuming mono n , + \t\t\t\t\tnitems); + \t\t\tScr->Monochrome = MONOCHROME;  /* assume */ + \t\t} + \t} +        \t/* setup default colors */   \tScr->FirstTime = TRUE;  --  George D M Ross, Department of Computer Science, University of Edinburgh      Kings Buildings, Mayfield Road, Edinburgh, Scotland, EH9 3JZ Mail: gdmr@dcs.ed.ac.uk      Voice: 031-650 5147      Fax: 031-667 7209 